
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="js/elementui/index.css">
    <script src="js/vue.js"></script>
    <script  src="js/elementui/index.js"></script>
    <script src="js/axios.min.js"></script>
    <link rel="stylesheet" href="css/tea.css">
</head>
<body>
<div id="app">
    <div>
        <el-input v-model="cour_name"></el-input>
        <el-button type="success" @click="search">搜索</el-button>
     </div>

    <el-table :data="tableData" style="width: 100%" >
        <el-table-column
                type="index"
                width="50">
        </el-table-column>

        <el-table-column prop="courName" label="阅览室">
        </el-table-column>

        <el-table-column prop="courContent" label="卡号">
        </el-table-column>

        <el-table-column prop="courDetails" label="名称">
        </el-table-column>

        <el-table-column prop="courIsputaway" label="进入时间">
        </el-table-column>

       <el-table-column label="操作">

            <template slot-scope="scope">
                 <el-button size="mini" onclick="window.location.href='admin.html'">管理</el-button>

                </el-breadcrumb>


                <el-button size="mini"
                        type="danger"
                        @click="handleDelete(scope.$index, scope.row)">删除</el-button>
            </template>
        </el-table-column>
    </el-table>
    <div style="display: flex;justify-content: center">
        <el-pagination
                layout="prev, pager, next"
                :total="total" current-page.sync="page" @current-change="pageChange">
        </el-pagination>
    </div>

</div>
</body>
<script>
     //跳转

    var Main = {
        data() {
            return {
                tableData: [],
                cour_name: "",
                page: 1,
                pageSize: 10,
                total: 0,

            }
        },
        methods: {

            //点击删除
            handleDelete(index, row) {
                this.$confirm('此操作将永久删除该文件, 是否继续?', '提示', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning',
                    center: true
                }).then(() => {
                    axios({
                           method: 'post',
                           url: '/api/teacher/course/deleteCourseById',
                           params: {
                               courId: row.courId
                           },
                           headers: {
                               "Authorization": "bearer " + sessionStorage.getItem("access_token")
                           }
                       })
                    this.queryCourse()
                    this.$message({
                        type: 'success',
                        message: '删除成功!',

                    });

                }).catch(() => {
                    this.$message({
                        type: 'info',
                        message: '已取消删除'
                    });
                })




            },


    pageChange(page) {
                this.page = page;
                this.queryCourse();
            },
            search() {
                this.page = 1;
                this.queryCourse();
            },
               //分页查询课程
            queryCourse() {
                axios({
                    method: 'get',
                    url: '/api/teacher/course/getPaginate',
                    params: {
                        page: this.page,
                        pageSize: this.pageSize,
                        courName: this.cour_name
                    },
                    headers: {
                        "Authorization": "bearer " + sessionStorage.getItem("access_token")
                    }
                })
                    .then(res => {
                            let data = res.data;

                            this.total = data.totalElements;
                            this.tableData = data.content;

                        }
                    )

            }
        },
        mounted() {
            // 初始化数据
            this.queryCourse()
        }
    }

    var Component = Vue.extend(Main)
    new Component().$mount('#app')
</script>
</html>

